<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2026-02-20">
<meta name="description" content="A complete mathematical derivation of the Black-Scholes call option formula, from Geometric Brownian Motion to the final PDE and Feynman-Kac solution.">

<title>Concept: The Black-Scholes Model – Jordan’s Projects</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<link href="../../..//assets/favicon.png" rel="icon" type="image/png">
<script src="../../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-ed96de9b727972fe78a7b5d16c58bf87.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap-f157d37ced3fdb2c46924f401e9f658f.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-V7YLYPVKHH"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-V7YLYPVKHH', { 'anonymize_ip': true});
</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../../styles.css">
<meta property="og:title" content="Concept: The Black-Scholes Model – Jordan’s Projects">
<meta property="og:description" content="A complete mathematical derivation of the Black-Scholes call option formula, from Geometric Brownian Motion to the final PDE and Feynman-Kac solution.">
<meta property="og:image" content="https://jordanchongja.github.io/notes/posts/Black-Sholes-Derivation/call-option.png">
<meta property="og:site_name" content="Jordan's Projects">
<meta property="og:image:height" content="248">
<meta property="og:image:width" content="685">
<meta property="og:image:alt" content="3D Surface Plot of Black-Scholes Call Prices">
<meta name="twitter:title" content="Concept: The Black-Scholes Model – Jordan’s Projects">
<meta name="twitter:description" content="A complete mathematical derivation of the Black-Scholes call option formula, from Geometric Brownian Motion to the final PDE and Feynman-Kac solution.">
<meta name="twitter:image" content="https://jordanchongja.github.io/notes/posts/Black-Sholes-Derivation/call-option.png">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image-height" content="248">
<meta name="twitter:image-width" content="685">
<meta name="twitter:image:alt" content="3D Surface Plot of Black-Scholes Call Prices">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Jordan’s Projects</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../projects/index.html"> 
<span class="menu-text">Projects</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../notes/index.html"> 
<span class="menu-text">Notes</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../readings/index.html"> 
<span class="menu-text">Readings</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../assets/Jordan_Chong_CV.pdf" target="_blank"> 
<span class="menu-text">CV</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/jordan-chong-88a02b172/"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/jordanchongja"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#the-full-mathematical-derivation-of-the-call-formula" id="toc-the-full-mathematical-derivation-of-the-call-formula" class="nav-link active" data-scroll-target="#the-full-mathematical-derivation-of-the-call-formula">The Full Mathematical Derivation of the Call Formula</a>
  <ul class="collapse">
  <li><a href="#the-stochastic-framework" id="toc-the-stochastic-framework" class="nav-link" data-scroll-target="#the-stochastic-framework">1. The Stochastic Framework</a></li>
  <li><a href="#the-taylor-series-expansion-the-divergence-from-ordinary-calculus" id="toc-the-taylor-series-expansion-the-divergence-from-ordinary-calculus" class="nav-link" data-scroll-target="#the-taylor-series-expansion-the-divergence-from-ordinary-calculus">2. The Taylor Series Expansion (The Divergence from Ordinary Calculus)</a></li>
  <li><a href="#analyzing-delta-x2-and-the-rules-of-stochastic-calculus" id="toc-analyzing-delta-x2-and-the-rules-of-stochastic-calculus" class="nav-link" data-scroll-target="#analyzing-delta-x2-and-the-rules-of-stochastic-calculus">3. Analyzing <span class="math inline">\((\Delta X)^2\)</span> and the Rules of Stochastic Calculus</a></li>
  <li><a href="#final-substitution" id="toc-final-substitution" class="nav-link" data-scroll-target="#final-substitution">4. Final Substitution</a></li>
  <li><a href="#the-result-itôs-lemma" id="toc-the-result-itôs-lemma" class="nav-link" data-scroll-target="#the-result-itôs-lemma">5. The Result: Itô’s Lemma</a></li>
  <li><a href="#step-2-constructing-the-riskless-portfolio-delta-hedging" id="toc-step-2-constructing-the-riskless-portfolio-delta-hedging" class="nav-link" data-scroll-target="#step-2-constructing-the-riskless-portfolio-delta-hedging">Step 2: Constructing the Riskless Portfolio (Delta Hedging)</a></li>
  <li><a href="#step-3-the-principle-of-no-arbitrage-and-the-black-scholes-pde" id="toc-step-3-the-principle-of-no-arbitrage-and-the-black-scholes-pde" class="nav-link" data-scroll-target="#step-3-the-principle-of-no-arbitrage-and-the-black-scholes-pde">Step 3: The Principle of No-Arbitrage and the Black-Scholes PDE</a></li>
  <li><a href="#interlude-the-fork-in-the-road-how-do-we-solve-this-pde" id="toc-interlude-the-fork-in-the-road-how-do-we-solve-this-pde" class="nav-link" data-scroll-target="#interlude-the-fork-in-the-road-how-do-we-solve-this-pde">Interlude: The Fork in the Road (How do we solve this PDE?)</a></li>
  <li><a href="#step-4-the-risk-neutral-expectation-feynman-kac" id="toc-step-4-the-risk-neutral-expectation-feynman-kac" class="nav-link" data-scroll-target="#step-4-the-risk-neutral-expectation-feynman-kac">Step 4: The Risk-Neutral Expectation (Feynman-Kac)</a></li>
  <li><a href="#step-5-splitting-and-solving-the-integrals" id="toc-step-5-splitting-and-solving-the-integrals" class="nav-link" data-scroll-target="#step-5-splitting-and-solving-the-integrals">Step 5: Splitting and Solving the Integrals</a></li>
  <li><a href="#step-6-the-final-black-scholes-formula" id="toc-step-6-the-final-black-scholes-formula" class="nav-link" data-scroll-target="#step-6-the-final-black-scholes-formula">Step 6: The Final Black-Scholes Formula</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">
<div style="margin-top: 50px;"></div>

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Concept: The Black-Scholes Model</h1>
  <div class="quarto-categories">
    <div class="quarto-category">Stochastic Calculus</div>
    <div class="quarto-category">Options Pricing</div>
    <div class="quarto-category">Quantitative Finance</div>
  </div>
  </div>

<div>
  <div class="description">
    A complete mathematical derivation of the Black-Scholes call option formula, from Geometric Brownian Motion to the final PDE and Feynman-Kac solution.
  </div>
</div>


<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">February 20, 2026</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p><img src="https://img.shields.io/badge/Python-3.10-3776AB?logo=python&amp;logoColor=white" class="img-fluid"> <img src="https://img.shields.io/badge/Status-Completed-success.png" class="img-fluid"> <a href="https://github.com/yourname/repo"><img src="https://img.shields.io/badge/View_Source_Code-181717?logo=github&amp;logoColor=white.png" class="img-fluid" alt="GitHub"></a></p>
<style>
  #quarto-margin-sidebar {
    padding-top: 50px; /* Match this to your header margin */
  }
</style>
<section id="the-full-mathematical-derivation-of-the-call-formula" class="level2">
<h2 class="anchored" data-anchor-id="the-full-mathematical-derivation-of-the-call-formula">The Full Mathematical Derivation of the Call Formula</h2>
<p>To truly understand Black-Scholes, we must walk step-by-step from the assumption of the asset’s random walk to the final pricing formula. We do this by deriving Itô’s Lemma, establishing the Partial Differential Equation (PDE), transforming it into an expected value, and integrating.</p>
<hr>
<section id="the-stochastic-framework" class="level3">
<h3 class="anchored" data-anchor-id="the-stochastic-framework">1. The Stochastic Framework</h3>
<p>Suppose we have a stochastic process <span class="math inline">\(X_t\)</span> that models our asset price, following a generalized Itô drift-diffusion process:</p>
<p><span class="math display">\[
dX_t = \mu(X_t, t)dt + \sigma(X_t, t)dW_t
\]</span></p>
<p>Where: * <span class="math inline">\(\mu(X_t, t)\)</span> is the predictable, deterministic drift. * <span class="math inline">\(\sigma(X_t, t)\)</span> is the volatility (diffusion) scaling factor. * <span class="math inline">\(dW_t\)</span> is the increment of a standard Wiener process (Brownian motion), representing random market shocks.</p>
<p>We want to find the differential <span class="math inline">\(df\)</span> of a scalar function <span class="math inline">\(f(X_t, t)\)</span>—such as an option pricing function—that is at least twice-differentiable in <span class="math inline">\(x\)</span> and once-differentiable in <span class="math inline">\(t\)</span>.</p>
<hr>
</section>
<section id="the-taylor-series-expansion-the-divergence-from-ordinary-calculus" class="level3">
<h3 class="anchored" data-anchor-id="the-taylor-series-expansion-the-divergence-from-ordinary-calculus">2. The Taylor Series Expansion (The Divergence from Ordinary Calculus)</h3>
<p>We begin by examining the change in our function <span class="math inline">\(f\)</span> over an infinitesimally small time increment <span class="math inline">\(\Delta t\)</span>. We use a two-variable Taylor expansion:</p>
<p><span class="math display">\[
\Delta f \approx \frac{\partial f}{\partial t}\Delta t + \frac{\partial f}{\partial x}\Delta X + \frac{1}{2}\frac{\partial^2 f}{\partial x^2}(\Delta X)^2 + \frac{1}{2}\frac{\partial^2 f}{\partial t^2}(\Delta t)^2 + \frac{\partial^2 f}{\partial x \partial t}(\Delta X \Delta t) + \dots
\]</span></p>
<p><strong>The Core Difference:</strong> In standard, deterministic calculus, as <span class="math inline">\(\Delta t \to 0\)</span>, any terms of order higher than <span class="math inline">\(\Delta t\)</span> (like <span class="math inline">\(\Delta t^2\)</span> or <span class="math inline">\(\Delta x^2\)</span>) shrink to zero so rapidly that they become negligible. We simply drop them.</p>
<p>However, in the stochastic world, the path of <span class="math inline">\(X_t\)</span> is driven by the random walk of <span class="math inline">\(W_t\)</span>. Brownian motion is continuous but nowhere differentiable—it is infinitely jagged.</p>
<p>Because of this extreme jaggedness, the squared variation <span class="math inline">\((\Delta X)^2\)</span> does <em>not</em> shrink to zero faster than <span class="math inline">\(\Delta t\)</span>. It is large enough that it must be kept in our equation.</p>
<hr>
</section>
<section id="analyzing-delta-x2-and-the-rules-of-stochastic-calculus" class="level3">
<h3 class="anchored" data-anchor-id="analyzing-delta-x2-and-the-rules-of-stochastic-calculus">3. Analyzing <span class="math inline">\((\Delta X)^2\)</span> and the Rules of Stochastic Calculus</h3>
<p>To see why the second-order term survives, we substitute our definition of <span class="math inline">\(\Delta X\)</span> into the squared term:</p>
<p><span class="math display">\[
(\Delta X)^2 = (\mu \Delta t + \sigma \Delta W)^2
\]</span> <span class="math display">\[
(\Delta X)^2 = \mu^2 (\Delta t)^2 + 2\mu\sigma (\Delta t \Delta W) + \sigma^2 (\Delta W)^2
\]</span></p>
<p>Now, we take the limit as <span class="math inline">\(\Delta t \to 0\)</span> and apply the formal multiplication rules of stochastic calculus (Itô multiplication table): * <span class="math inline">\(dt \cdot dt = 0\)</span> (Shrinks too fast) * <span class="math inline">\(dt \cdot dW_t = 0\)</span> (Shrinks too fast, scales as <span class="math inline">\(dt^{3/2}\)</span>) * <strong><span class="math inline">\(dW_t \cdot dW_t = dt\)</span></strong> (The critical survival)</p>
<blockquote class="blockquote">
<h3 id="deep-dive-why-does-dw_t2-dt" class="anchored">Deep Dive: Why does <span class="math inline">\((dW_t)^2 = dt\)</span>?</h3>
<p>The jump to <span class="math inline">\((dW_t)^2 = dt\)</span> is the most unintuitive part of stochastic calculus. How can a random variable squared equal a deterministic, predictable passage of time? We can break this down statistically, behaviorally, and heuristically.</p>
<h4 id="the-statistical-properties" class="anchored">1. The Statistical Properties</h4>
<p>Here is the exact step-by-step logic chain to prove this equivalence: * <strong>Definition:</strong> By definition, an increment of a Wiener process follows a normal distribution centered at zero: <span class="math inline">\(\Delta W \sim \mathcal{N}(0, \Delta t)\)</span>. * <strong>Variance Formula:</strong> From fundamental statistics, the variance of any random variable is <span class="math inline">\(Var[\Delta W] = E[(\Delta W)^2] - (E[\Delta W])^2\)</span>. * <strong>Plug in the numbers:</strong> Since the mean expected value <span class="math inline">\(E[\Delta W]\)</span> is exactly <span class="math inline">\(0\)</span>, squaring it <span class="math inline">\((E[\Delta W])^2\)</span> is also <span class="math inline">\(0\)</span>. * <strong>The Reduction:</strong> This leaves us with a perfectly simplified equation: <span class="math inline">\(Var[\Delta W] = E[(\Delta W)^2]\)</span>. * <strong>The Result:</strong> Because the variance of a Wiener process over time <span class="math inline">\(\Delta t\)</span> is defined as <span class="math inline">\(\Delta t\)</span>, it must be mathematically true that the expected value of the squared increment is the time step itself: <span class="math inline">\(E[(\Delta W)^2] = \Delta t\)</span>.</p>
<h4 id="the-law-of-large-numbers-quadratic-variation" class="anchored">2. The Law of Large Numbers (Quadratic Variation)</h4>
<p>One might naturally ask: <em>“If <span class="math inline">\(E[(\Delta W)^2] = \Delta t\)</span>, isn’t <span class="math inline">\((\Delta W)^2\)</span> still a random variable around that expected value?”</em></p>
<p>Yes, for a single, isolated step, it is. However, Itô’s Lemma deals with continuous time, where the limit as <span class="math inline">\(\Delta t \to 0\)</span>. If we divide a time interval <span class="math inline">\([0, T]\)</span> into <span class="math inline">\(n\)</span> microscopic pieces, the total sum of these squared increments is called the <strong>Quadratic Variation</strong>: <span class="math display">\[[W, W]_T = \lim_{n \to \infty} \sum_{i=1}^{n} (W_{t_i} - W_{t_{i-1}})^2\]</span></p>
<p>As <span class="math inline">\(n\)</span> becomes infinitely large, we must look at the variance of this sum. For a normal distribution, the fourth moment allows us to calculate the variance of the square: <span class="math display">\[Var[(\Delta W)^2] = E[(\Delta W)^4] - (E[(\Delta W)^2])^2 = 3(\Delta t)^2 - (\Delta t)^2 = 2(\Delta t)^2\]</span></p>
<p>Because the variance of <span class="math inline">\((\Delta W)^2\)</span> is proportional to <span class="math inline">\((\Delta t)^2\)</span>, it shrinks to zero vastly faster than the mean (<span class="math inline">\(\Delta t\)</span>). In the continuous limit, the randomness completely “washes out,” leaving only the deterministic expected value. The sum of squares behaves perfectly like a ticking clock.</p>
<h4 id="the-heuristic-comparison" class="anchored">3. The Heuristic Comparison</h4>
<p>To visualize why this is unique to random walks, compare it to a standard smooth function, <span class="math inline">\(g(t) = t\)</span>: * <strong>Standard Calculus:</strong> <span class="math inline">\(\Delta g = \Delta t\)</span>. Therefore, <span class="math inline">\((\Delta g)^2 = (\Delta t)^2\)</span>. As <span class="math inline">\(\Delta t \to 0\)</span>, this squared term essentially vanishes to zero. * <strong>Stochastic Calculus:</strong> <span class="math inline">\(\Delta W \approx \sqrt{\Delta t}\)</span>. Therefore, <span class="math inline">\((\Delta W)^2 \approx \Delta t\)</span>.</p>
<p>Because Brownian motion is inherently “square-root-of-time” risky, its square is of the exact same “size” as time itself.</p>
</blockquote>
<hr>
</section>
<section id="final-substitution" class="level3">
<h3 class="anchored" data-anchor-id="final-substitution">4. Final Substitution</h3>
<p>Now we return to our original Taylor expansion. Knowing which terms survive the limit as <span class="math inline">\(\Delta t \to 0\)</span>, we truncate the series, keeping only the terms of order <span class="math inline">\(dt\)</span> or <span class="math inline">\(dW_t\)</span>:</p>
<p><span class="math display">\[
df = \frac{\partial f}{\partial t}dt + \frac{\partial f}{\partial x}dX_t + \frac{1}{2}\frac{\partial^2 f}{\partial x^2}(dX_t)^2
\]</span></p>
<p>Next, we substitute our initial definitions: * <span class="math inline">\(dX_t = \mu dt + \sigma dW_t\)</span> * <span class="math inline">\((dX_t)^2 = \sigma^2 dt\)</span></p>
<p><span class="math display">\[
df = \frac{\partial f}{\partial t}dt + \frac{\partial f}{\partial x}(\mu dt + \sigma dW_t) + \frac{1}{2}\frac{\partial^2 f}{\partial x^2}(\sigma^2 dt)
\]</span></p>
<hr>
</section>
<section id="the-result-itôs-lemma" class="level3">
<h3 class="anchored" data-anchor-id="the-result-itôs-lemma">5. The Result: Itô’s Lemma</h3>
<p>Finally, we group the deterministic <span class="math inline">\(dt\)</span> terms together and separate the stochastic <span class="math inline">\(dW_t\)</span> term. This yields the foundational equation of stochastic calculus—<strong>Itô’s Lemma</strong>:</p>
<p><span class="math display">\[
df = \left( \frac{\partial f}{\partial t} + \mu \frac{\partial f}{\partial x} + \frac{1}{2} \sigma^2 \frac{\partial^2 f}{\partial x^2} \right) dt + \sigma \frac{\partial f}{\partial x} dW_t
\]</span></p>
<p><em>(Note for Black-Scholes: In our options pricing model, <span class="math inline">\(f\)</span> is the option price <span class="math inline">\(V(S, t)\)</span>, the asset <span class="math inline">\(X_t\)</span> is the stock price <span class="math inline">\(S_t\)</span>, the drift <span class="math inline">\(\mu\)</span> becomes <span class="math inline">\(\mu S_t\)</span>, and the diffusion <span class="math inline">\(\sigma\)</span> becomes <span class="math inline">\(\sigma S_t\)</span>.)</em></p>
<hr>
</section>
<section id="step-2-constructing-the-riskless-portfolio-delta-hedging" class="level3">
<h3 class="anchored" data-anchor-id="step-2-constructing-the-riskless-portfolio-delta-hedging">Step 2: Constructing the Riskless Portfolio (Delta Hedging)</h3>
<p>Now that we have Itô’s Lemma to describe how the option price <span class="math inline">\(V(S, t)\)</span> changes over time, we need a way to find its fair value. Fischer Black and Myron Scholes realized that if you hold the right combination of the option and the underlying stock, you can completely cancel out the unpredictable market shocks (<span class="math inline">\(dW_t\)</span>).</p>
<p>We construct a hypothetical portfolio, denoted as <span class="math inline">\(\Pi\)</span>. In this portfolio, we hold exactly one long position in our option, and we short sell a specific number of shares of the underlying stock. We will call this number of shares <span class="math inline">\(\Delta\)</span> (not to be confused with a time step <span class="math inline">\(\Delta t\)</span>).</p>
<p>The value of our portfolio at any given time is: <span class="math display">\[
\Pi = V - \Delta S
\]</span></p>
<p>We want to observe how the value of this portfolio changes over a microscopic time step <span class="math inline">\(dt\)</span>. By applying basic differentiation: <span class="math display">\[
d\Pi = dV - \Delta dS
\]</span></p>
<p>Now, we substitute the two massive equations we have built so far: 1. <strong><span class="math inline">\(dV\)</span>:</strong> The change in the option price (from Itô’s Lemma). 2. <strong><span class="math inline">\(dS\)</span>:</strong> The change in the stock price (from our Geometric Brownian Motion assumption: <span class="math inline">\(dS = \mu S dt + \sigma S dW_t\)</span>).</p>
<p>Substituting these into our portfolio equation yields: <span class="math display">\[
d\Pi = \left[ \left( \frac{\partial V}{\partial t} + \mu S \frac{\partial V}{\partial S} + \frac{1}{2} \sigma^2 S^2 \frac{\partial^2 V}{\partial S^2} \right) dt + \sigma S \frac{\partial V}{\partial S} dW_t \right] - \Delta \left[ \mu S dt + \sigma S dW_t \right]
\]</span></p>
<p>This looks messy, but we can organize it by grouping all the deterministic parts (attached to <span class="math inline">\(dt\)</span>) and all the random, volatile parts (attached to <span class="math inline">\(dW_t\)</span>):</p>
<p><span class="math display">\[
d\Pi = \left( \frac{\partial V}{\partial t} + \mu S \frac{\partial V}{\partial S} + \frac{1}{2} \sigma^2 S^2 \frac{\partial^2 V}{\partial S^2} - \Delta \mu S \right) dt + \left( \sigma S \frac{\partial V}{\partial S} - \Delta \sigma S \right) dW_t
\]</span></p>
<section id="eliminating-the-randomness" class="level4">
<h4 class="anchored" data-anchor-id="eliminating-the-randomness">Eliminating the Randomness</h4>
<p>The second set of parentheses contains the <span class="math inline">\(dW_t\)</span> term. This is the sole source of risk in our portfolio. If the market suddenly crashes or spikes, this is the term that dictates our losses or gains.</p>
<p>The brilliance of the Black-Scholes model lies in a simple algebraic observation: we can force that entire term to equal zero. We do this by continuously adjusting the number of shares we short (<span class="math inline">\(\Delta\)</span>).</p>
<p>If we deliberately choose: <span class="math display">\[
\Delta = \frac{\partial V}{\partial S}
\]</span></p>
<p>Then the random term becomes: <span class="math display">\[
\left( \sigma S \frac{\partial V}{\partial S} - \frac{\partial V}{\partial S} \sigma S \right) dW_t = 0 \cdot dW_t = 0
\]</span></p>
<p>By setting our stock position equal to the partial derivative of the option with respect to the stock (which traders now call the option’s “Delta”), the random shocks completely cancel out. The portfolio becomes completely immune to small movements in the underlying asset.</p>
<p>What we are left with is a portfolio whose change in value is entirely deterministic, driven only by the passage of time: <span class="math display">\[
d\Pi = \left( \frac{\partial V}{\partial t} + \frac{1}{2} \sigma^2 S^2 \frac{\partial^2 V}{\partial S^2} \right) dt
\]</span></p>
<hr>
</section>
</section>
<section id="step-3-the-principle-of-no-arbitrage-and-the-black-scholes-pde" class="level3">
<h3 class="anchored" data-anchor-id="step-3-the-principle-of-no-arbitrage-and-the-black-scholes-pde">Step 3: The Principle of No-Arbitrage and the Black-Scholes PDE</h3>
<p>At the end of Step 2, we successfully engineered a portfolio <span class="math inline">\(\Pi\)</span> that is completely insulated from the random shocks of the stock market. Because we chose to hold <span class="math inline">\(\Delta = \frac{\partial V}{\partial S}\)</span> shares of stock short against our long option, the <span class="math inline">\(dW_t\)</span> term was mathematically forced to zero.</p>
<p>We were left with a portfolio whose change in value is entirely deterministic, driven only by the smooth passage of time: <span class="math display">\[
d\Pi = \left( \frac{\partial V}{\partial t} + \frac{1}{2} \sigma^2 S^2 \frac{\partial^2 V}{\partial S^2} \right) dt
\]</span></p>
<p>Now, we must ask an economic question: <strong>If a portfolio has absolutely zero risk, how much return should it generate?</strong></p>
<section id="the-financial-law-of-gravity-no-arbitrage" class="level4">
<h4 class="anchored" data-anchor-id="the-financial-law-of-gravity-no-arbitrage">The Financial Law of Gravity: No-Arbitrage</h4>
<p>In an efficient market, there is a fundamental law known as the <strong>Principle of No-Arbitrage</strong>. An “arbitrage” is a guaranteed, risk-free profit that requires zero net investment.</p>
<p>If our completely riskless portfolio <span class="math inline">\(\Pi\)</span> earned a return <em>higher</em> than a risk-free government bond (yielding the risk-free rate, <span class="math inline">\(r\)</span>), an arbitrageur could borrow infinite amounts of money at rate <span class="math inline">\(r\)</span> from the bank, invest it into our portfolio <span class="math inline">\(\Pi\)</span>, and pocket the difference completely risk-free. Conversely, if <span class="math inline">\(\Pi\)</span> earned <em>less</em> than <span class="math inline">\(r\)</span>, an arbitrageur would short our portfolio and put the cash into the bank, again locking in a risk-free profit.</p>
<p>Because market forces instantly exploit and close these loopholes, a fundamental truth emerges: <strong>Any portfolio with zero risk must earn exactly the risk-free interest rate.</strong></p>
<p>Mathematically, the growth of our portfolio over the time step <span class="math inline">\(dt\)</span> must equal the continuously compounded risk-free rate <span class="math inline">\(r\)</span> multiplied by the current value of the portfolio: <span class="math display">\[
d\Pi = r \Pi dt
\]</span></p>
</section>
<section id="equating-the-math-and-the-economics" class="level4">
<h4 class="anchored" data-anchor-id="equating-the-math-and-the-economics">Equating the Math and the Economics</h4>
<p>We now have two completely different ways to describe the change in our portfolio (<span class="math inline">\(d\Pi\)</span>). 1. <strong>The Calculus View</strong> (from Itô’s Lemma): <span class="math inline">\(d\Pi = \left( \frac{\partial V}{\partial t} + \frac{1}{2} \sigma^2 S^2 \frac{\partial^2 V}{\partial S^2} \right) dt\)</span> 2. <strong>The Economics View</strong> (from No-Arbitrage): <span class="math inline">\(d\Pi = r \Pi dt\)</span></p>
<p>Because these describe the exact same portfolio, we can set them equal to each other: <span class="math display">\[
\left( \frac{\partial V}{\partial t} + \frac{1}{2} \sigma^2 S^2 \frac{\partial^2 V}{\partial S^2} \right) dt = r \Pi dt
\]</span></p>
<p>Recall from Step 2 that the total value of our portfolio is <span class="math inline">\(\Pi = V - \Delta S\)</span>, and we defined <span class="math inline">\(\Delta = \frac{\partial V}{\partial S}\)</span>. Let’s substitute that back in: <span class="math display">\[
\left( \frac{\partial V}{\partial t} + \frac{1}{2} \sigma^2 S^2 \frac{\partial^2 V}{\partial S^2} \right) dt = r \left( V - \frac{\partial V}{\partial S} S \right) dt
\]</span></p>
<p>Since both sides are simply multiplying a rate by the time step <span class="math inline">\(dt\)</span>, we can divide both sides by <span class="math inline">\(dt\)</span> to remove it entirely: <span class="math display">\[
\frac{\partial V}{\partial t} + \frac{1}{2} \sigma^2 S^2 \frac{\partial^2 V}{\partial S^2} = rV - rS \frac{\partial V}{\partial S}
\]</span></p>
<p>Finally, let’s rearrange this equation by moving everything to the left side so that it equals zero.</p>
<p><span class="math display">\[
\frac{\partial V}{\partial t} + rS \frac{\partial V}{\partial S} + \frac{1}{2} \sigma^2 S^2 \frac{\partial^2 V}{\partial S^2} - rV = 0
\]</span></p>
</section>
<section id="the-grand-reveal-deconstructing-the-pde" class="level4">
<h4 class="anchored" data-anchor-id="the-grand-reveal-deconstructing-the-pde">The Grand Reveal: Deconstructing the PDE</h4>
<p>This is it. This is the <strong>Black-Scholes Partial Differential Equation</strong>. It is one of the most famous equations in finance, and every single term has a physical, trading interpretation, often mapped directly to the “Greeks”:</p>
<ol type="1">
<li><strong><span class="math inline">\(\frac{\partial V}{\partial t}\)</span> (Theta - Time Decay):</strong> This is negative for options. As time ticks closer to expiration, the option loses value because there is less time for the stock to make a favorable move.</li>
<li><strong><span class="math inline">\(rS \frac{\partial V}{\partial S}\)</span> (Risk-Neutral Drift):</strong> This term represents the cost of financing the Delta-hedged position in the stock.</li>
<li><strong><span class="math inline">\(\frac{1}{2} \sigma^2 S^2 \frac{\partial^2 V}{\partial S^2}\)</span> (Gamma - Convexity):</strong> This is the engine of the option’s value. Because the second derivative (<span class="math inline">\(\Gamma\)</span>) is positive, volatility (<span class="math inline">\(\sigma^2\)</span>) directly <em>adds</em> value to the option. This perfectly offsets the bleed from time decay (<span class="math inline">\(\Theta\)</span>).</li>
<li><strong><span class="math inline">\(- rV\)</span> (Discounting):</strong> This simply discounts the final payoff of the option back to present value at the risk-free rate.</li>
</ol>
<p>The beauty of the Black-Scholes PDE is that the expected return of the stock (<span class="math inline">\(\mu\)</span>) has completely vanished! Because we can hedge away the directional risk of the stock, the option’s price depends only on the stock’s <em>volatility</em> (<span class="math inline">\(\sigma\)</span>), not its expected direction.</p>
<hr>
</section>
</section>
<section id="interlude-the-fork-in-the-road-how-do-we-solve-this-pde" class="level3">
<h3 class="anchored" data-anchor-id="interlude-the-fork-in-the-road-how-do-we-solve-this-pde">Interlude: The Fork in the Road (How do we solve this PDE?)</h3>
<p>At the end of Step 3, we successfully derived the Black-Scholes PDE: <span class="math display">\[
\frac{\partial V}{\partial t} + rS \frac{\partial V}{\partial S} + \frac{1}{2} \sigma^2 S^2 \frac{\partial^2 V}{\partial S^2} - rV = 0
\]</span></p>
<p>This equation dictates exactly how the option price must behave to prevent arbitrage. But an equation is not a price. To get a dollar value, we have to solve this PDE subject to a boundary condition: at maturity (<span class="math inline">\(T\)</span>), a call option is worth exactly <span class="math inline">\(\max(S_T - K, 0)\)</span>.</p>
<p>From here, quantitative finance splits into two distinct paths: <strong>Numerical Methods</strong> and <strong>Analytical Methods</strong>.</p>
<section id="path-a-the-numerical-approach-finite-difference-methods" class="level4">
<h4 class="anchored" data-anchor-id="path-a-the-numerical-approach-finite-difference-methods">Path A: The Numerical Approach (Finite Difference Methods)</h4>
<p>Instead of looking for a perfect algebraic formula, Numerical Methods use brute-force computation. We chop time and asset prices into a massive grid (a matrix). We know the exact payoff at expiration (the rightmost edge of the grid), and we mathematically step backward through time, cell by cell, until we reach “today” (the leftmost edge).</p>
<p>To do this, we approximate the continuous derivatives from our PDE using discrete “differences” on our grid. Let <span class="math inline">\(V_i^j\)</span> be the option price at stock price node <span class="math inline">\(i\)</span> and time step <span class="math inline">\(j\)</span>. * <strong>Delta (First Derivative of Space):</strong> <span class="math inline">\(\frac{\partial V}{\partial S} \approx \frac{V_{i+1}^j - V_{i-1}^j}{2\Delta S}\)</span> * <strong>Gamma (Second Derivative of Space):</strong> <span class="math inline">\(\frac{\partial^2 V}{\partial S^2} \approx \frac{V_{i+1}^j - 2V_i^j + V_{i-1}^j}{(\Delta S)^2}\)</span> * <strong>Theta (First Derivative of Time):</strong> <span class="math inline">\(\frac{\partial V}{\partial t} \approx \frac{V_i^{j+1} - V_i^j}{\Delta t}\)</span></p>
<p>By substituting these grid approximations into the Black-Scholes PDE, we can build a programmatic solver. There are three main ways to construct this grid, trading off between computational speed and mathematical stability.</p>
<section id="the-explicit-scheme" class="level5">
<h5 class="anchored" data-anchor-id="the-explicit-scheme">1. The Explicit Scheme</h5>
<p>The Explicit method is the simplest. To find the unknown option price at a specific node one step back in time (<span class="math inline">\(V_i^j\)</span>), it relies <em>only</em> on the already-known information from the nodes immediately ahead of it in the future (<span class="math inline">\(V_{i-1}^{j+1}, V_i^{j+1}, V_{i+1}^{j+1}\)</span>).</p>
<ul>
<li><strong>Pros:</strong> It is incredibly easy to code. The calculation for each node is a simple linear equation.</li>
<li><strong>Cons:</strong> It is <strong>conditionally stable</strong>. If your time steps (<span class="math inline">\(\Delta t\)</span>) are too large compared to your price steps (<span class="math inline">\(\Delta S\)</span>), the mathematical errors compound exponentially. The grid “blows up,” and your computer will output an option price of infinity.</li>
</ul>
</section>
<section id="the-implicit-scheme" class="level5">
<h5 class="anchored" data-anchor-id="the-implicit-scheme">2. The Implicit Scheme</h5>
<p>The Implicit method flips the logic. Instead of expressing the current time step as a function of the future, it expresses the <em>future</em> known boundary conditions as a function of the <em>current</em> unknown time step.</p>
<p>Because multiple unknown nodes depend on each other simultaneously, you cannot calculate them one by one. You must solve the entire column of the grid at the exact same time using a system of linear equations (specifically, by inverting a tridiagonal matrix).</p>
<ul>
<li><strong>Pros:</strong> It is <strong>unconditionally stable</strong>. No matter how large you make your time steps, the math will never blow up.</li>
<li><strong>Cons:</strong> It is computationally expensive. Solving a massive matrix at every single time step requires significantly more processing power.</li>
</ul>
</section>
<section id="the-crank-nicolson-scheme-the-industry-standard" class="level5">
<h5 class="anchored" data-anchor-id="the-crank-nicolson-scheme-the-industry-standard">3. The Crank-Nicolson Scheme (The Industry Standard)</h5>
<p>In 1947, John Crank and Phyllis Nicolson realized that if you take an exact 50/50 average of the Explicit and Implicit methods, magical things happen to the error terms.</p>
<p>The Crank-Nicolson method centers the time difference exactly halfway between step <span class="math inline">\(j\)</span> and step <span class="math inline">\(j+1\)</span>. Like the Implicit method, it requires solving a tridiagonal matrix (often using a lightning-fast technique called the <strong>Thomas Algorithm</strong>).</p>
<ul>
<li><strong>The Verdict:</strong> This is the gold standard for PDE options pricing. It is unconditionally stable (like Implicit) but converges on the true price much faster and with significantly higher accuracy than the other two methods.</li>
</ul>
<p><strong>Why use Finite Difference Methods?</strong> If we just want to price a standard European option, FDM is overkill. But for <strong>American Options</strong>, which can be exercised early, FDM is mandatory. Because we step backward through time cell by cell, we can stop at every single node and ask the computer: <em>“Is the theoretical option price here lower than the immediate payoff of early exercise? If yes, replace the theoretical price with the exercise value.”</em></p>
</section>
</section>
<section id="path-b-the-analytical-approach" class="level4">
<h4 class="anchored" data-anchor-id="path-b-the-analytical-approach">Path B: The Analytical Approach</h4>
<p>While grids are powerful, for European options (which cannot be exercised early), we do not need to step through time mechanically. We can use advanced probability theory to solve the PDE perfectly, instantly, and in one continuous leap.</p>
<p>This brings us back to our derivation, and the genius of Richard Feynman and Mark Kac.</p>
<hr>
</section>
</section>
<section id="step-4-the-risk-neutral-expectation-feynman-kac" class="level3">
<h3 class="anchored" data-anchor-id="step-4-the-risk-neutral-expectation-feynman-kac">Step 4: The Risk-Neutral Expectation (Feynman-Kac)</h3>
<p>Solving this PDE directly requires complex substitutions to turn it into a heat equation. Instead, we use the <strong>Feynman-Kac theorem</strong>, which states that the solution to this PDE, subject to the European Call boundary condition at maturity <span class="math inline">\(V(S, T) = \max(S_T - K, 0)\)</span>, can be written as a discounted expected value under the risk-neutral measure <span class="math inline">\(\mathbb{Q}\)</span>:</p>
<p><span class="math display">\[
C(S,t) = e^{-r(T-t)} \mathbb{E}^{\mathbb{Q}}[\max(S_T - K, 0)]
\]</span></p>
<section id="the-risk-neutral-measure-mathbbq" class="level4">
<h4 class="anchored" data-anchor-id="the-risk-neutral-measure-mathbbq">The Risk-Neutral Measure (<span class="math inline">\(\mathbb{Q}\)</span>)</h4>
<p>Notice the <span class="math inline">\(\mathbb{Q}\)</span> above the expectation operator. This indicates that we are calculating the expectation under the <strong>Risk-Neutral Measure</strong>, not the real-world probability measure (<span class="math inline">\(\mathbb{P}\)</span>).</p>
<p>Why? Remember when we delta-hedged our portfolio in Step 2? The real-world expected return of the stock (<span class="math inline">\(\mu\)</span>) completely disappeared from our math. Because the option price does not care about the stock’s true expected growth, we can pretend we live in a simplified “risk-neutral” universe. In this universe, all assets—including the risky stock—are expected to grow at exactly the risk-free rate <span class="math inline">\(r\)</span>.</p>
<p>So, we rewrite our stock’s stochastic differential equation (SDE), replacing <span class="math inline">\(\mu\)</span> with <span class="math inline">\(r\)</span>: <span class="math display">\[
dS_t = r S_t dt + \sigma S_t dW^{\mathbb{Q}}_t
\]</span></p>
</section>
<section id="solving-for-the-terminal-stock-price-s_t" class="level4">
<h4 class="anchored" data-anchor-id="solving-for-the-terminal-stock-price-s_t">Solving for the Terminal Stock Price (<span class="math inline">\(S_T\)</span>)</h4>
<p>To evaluate our expected payoff, we need an explicit formula for <span class="math inline">\(S_T\)</span>. We solve the risk-neutral SDE by applying Itô’s Lemma to the natural log of the stock price, <span class="math inline">\(f(S_t) = \ln(S_t)\)</span>.</p>
<p>Using Itô’s Lemma on <span class="math inline">\(\ln(S_t)\)</span> yields: <span class="math display">\[
d(\ln S_t) = \left( r - \frac{1}{2}\sigma^2 \right) dt + \sigma dW^{\mathbb{Q}}_t
\]</span></p>
<p><em>(Notice the <span class="math inline">\(-\frac{1}{2}\sigma^2\)</span> term appearing! This is the exact mathematical origin of the <strong>volatility drag</strong> we discussed in Section 1. The variance mathematically pulls down the expected geometric growth rate.)</em></p>
<p>Because the drift and volatility terms are now constants, we can cleanly integrate both sides from today (<span class="math inline">\(t\)</span>) to expiration (<span class="math inline">\(T\)</span>). Let <span class="math inline">\(\tau = T - t\)</span> (the time to maturity). <span class="math display">\[
\ln(S_T) - \ln(S_t) = \left( r - \frac{1}{2}\sigma^2 \right)\tau + \sigma (W_T - W_t)
\]</span></p>
<p>By taking the exponential of both sides, we get the explicit, log-normal distribution for the stock price at maturity: <span class="math display">\[
S_T = S_t \exp\left( \left(r - \frac{\sigma^2}{2}\right)\tau + \sigma \sqrt{\tau} Z \right)
\]</span></p>
<p>Where <span class="math inline">\(Z \sim \mathcal{N}(0,1)\)</span> is a standard normal random variable representing the total accumulated randomness between <span class="math inline">\(t\)</span> and <span class="math inline">\(T\)</span>.</p>
<hr>
</section>
</section>
<section id="step-5-splitting-and-solving-the-integrals" class="level3">
<h3 class="anchored" data-anchor-id="step-5-splitting-and-solving-the-integrals">Step 5: Splitting and Solving the Integrals</h3>
<p>We can now rewrite our expectation as an integral over the standard normal Probability Density Function (PDF), which is <span class="math inline">\(\phi(z) = \frac{1}{\sqrt{2\pi}}e^{-z^2/2}\)</span>:</p>
<p><span class="math display">\[
C(S,t) = e^{-r\tau} \int_{-\infty}^{\infty} \max(S_T(z) - K, 0) \phi(z) dz
\]</span></p>
<section id="finding-the-boundary-condition-dropping-the-max-function" class="level4">
<h4 class="anchored" data-anchor-id="finding-the-boundary-condition-dropping-the-max-function">Finding the Boundary Condition (Dropping the Max Function)</h4>
<p>The option only has a payoff when <span class="math inline">\(S_T &gt; K\)</span>. We need to find the critical value of our normal variable <span class="math inline">\(Z\)</span> where the stock price exactly equals the strike price (<span class="math inline">\(S_T = K\)</span>):</p>
<p><span class="math display">\[
S_t \exp\left( \left(r - \frac{\sigma^2}{2}\right)\tau + \sigma \sqrt{\tau} Z \right) &gt; K
\]</span> Take the natural log of both sides: <span class="math display">\[
\left(r - \frac{\sigma^2}{2}\right)\tau + \sigma \sqrt{\tau} Z &gt; \ln\left(\frac{K}{S_t}\right)
\]</span> Isolate <span class="math inline">\(Z\)</span>: <span class="math display">\[
Z &gt; \frac{\ln(K/S_t) - (r - \frac{\sigma^2}{2})\tau}{\sigma \sqrt{\tau}}
\]</span></p>
<p>Let’s define this entire right-side boundary threshold as <span class="math inline">\(-d_2\)</span>. Thus, the option is “in-the-money” and pays off whenever <span class="math inline">\(Z &gt; -d_2\)</span>. Because we know the lower bound, we can drop the <span class="math inline">\(\max()\)</span> function and restrict our integral bounds:</p>
<p><span class="math display">\[
C(S,t) = e^{-r\tau} \int_{-d_2}^{\infty} (S_T(z) - K) \phi(z) dz
\]</span></p>
</section>
<section id="splitting-the-integral" class="level4">
<h4 class="anchored" data-anchor-id="splitting-the-integral">Splitting the Integral</h4>
<p>We expand the terms and split this into two separate integrals: <span class="math display">\[
C(S,t) = \underbrace{e^{-r\tau} \int_{-d_2}^{\infty} S_T(z) \phi(z) dz}_{\text{Part A (Stock)}} \quad - \quad \underbrace{K e^{-r\tau} \int_{-d_2}^{\infty} \phi(z) dz}_{\text{Part B (Strike)}}
\]</span></p>
</section>
<section id="solving-part-b-the-strike-portion" class="level4">
<h4 class="anchored" data-anchor-id="solving-part-b-the-strike-portion">Solving Part B (The Strike Portion)</h4>
<p>Part B is incredibly straightforward. It is simply the discounted strike price multiplied by the probability that <span class="math inline">\(Z &gt; -d_2\)</span>. Because the standard normal distribution is perfectly symmetric, the probability of being greater than <span class="math inline">\(-d_2\)</span> is identical to the probability of being less than <span class="math inline">\(d_2\)</span>. Let <span class="math inline">\(N(\cdot)\)</span> denote the standard normal Cumulative Distribution Function (CDF). <span class="math display">\[
P(Z &gt; -d_2) = P(Z &lt; d_2) = N(d_2)
\]</span></p>
<p>So, Part B simplifies beautifully to: <span class="math display">\[
K e^{-r\tau} N(d_2)
\]</span></p>
</section>
<section id="solving-part-a-the-stock-portion" class="level4">
<h4 class="anchored" data-anchor-id="solving-part-a-the-stock-portion">Solving Part A (The Stock Portion)</h4>
<p>Part A is trickier because <span class="math inline">\(S_T(z)\)</span> also contains an exponential function. Let’s substitute <span class="math inline">\(S_T(z)\)</span> and <span class="math inline">\(\phi(z)\)</span> into the integral: <span class="math display">\[
e^{-r\tau} \int_{-d_2}^{\infty} S_t e^{(r - \sigma^2/2)\tau + \sigma \sqrt{\tau} z} \left( \frac{1}{\sqrt{2\pi}} e^{-z^2/2} \right) dz
\]</span></p>
<p>We pull the constants out of the integral and combine the <span class="math inline">\(e\)</span> exponents: <span class="math display">\[
S_t e^{-r\tau} e^{r\tau - \sigma^2\tau/2} \int_{-d_2}^{\infty} \frac{1}{\sqrt{2\pi}} e^{-\frac{1}{2}z^2 + \sigma \sqrt{\tau} z} dz
\]</span></p>
<p>The <span class="math inline">\(e^{-r\tau}\)</span> and <span class="math inline">\(e^{r\tau}\)</span> cancel out outside the integral. Inside the integral, we must <strong>complete the square</strong> in the exponent to turn it back into a recognizable normal distribution: <span class="math display">\[
-\frac{1}{2}z^2 + \sigma \sqrt{\tau} z = -\frac{1}{2}(z^2 - 2\sigma \sqrt{\tau} z)
\]</span> <span class="math display">\[
(z^2 - 2\sigma \sqrt{\tau} z) = (z - \sigma \sqrt{\tau})^2 - \sigma^2 \tau
\]</span></p>
<p>Substituting this completed square back into the exponent: <span class="math display">\[
S_t e^{-\sigma^2\tau/2} \int_{-d_2}^{\infty} \frac{1}{\sqrt{2\pi}} e^{-\frac{1}{2}(z - \sigma \sqrt{\tau})^2 + \sigma^2\tau/2} dz
\]</span></p>
<p>The <span class="math inline">\(e^{-\sigma^2\tau/2}\)</span> on the outside and <span class="math inline">\(e^{\sigma^2\tau/2}\)</span> on the inside cancel perfectly! We are left with: <span class="math display">\[
S_t \int_{-d_2}^{\infty} \frac{1}{\sqrt{2\pi}} e^{-\frac{1}{2}(z - \sigma \sqrt{\tau})^2} dz
\]</span></p>
<p>This integral is just a standard normal distribution that has been shifted by a mean of <span class="math inline">\(\sigma \sqrt{\tau}\)</span>. Let’s make a final substitution: let <span class="math inline">\(y = z - \sigma \sqrt{\tau}\)</span>, so <span class="math inline">\(dy = dz\)</span>. When <span class="math inline">\(z = -d_2\)</span>, our new lower bound becomes <span class="math inline">\(y = -d_2 - \sigma \sqrt{\tau}\)</span>.</p>
<p>By mathematical definition, we call this new boundary <span class="math inline">\(-d_1\)</span>. Therefore: <span class="math display">\[
d_1 = d_2 + \sigma \sqrt{\tau}
\]</span></p>
<p>The integral becomes: <span class="math display">\[
S_t \int_{-d_1}^{\infty} \frac{1}{\sqrt{2\pi}} e^{-y^2/2} dy
\]</span></p>
<p>Just like in Part B, this is simply <span class="math inline">\(S_t \times P(Y &gt; -d_1)\)</span>. Due to symmetry, this equals <span class="math inline">\(S_t N(d_1)\)</span>.</p>
<hr>
</section>
</section>
<section id="step-6-the-final-black-scholes-formula" class="level3">
<h3 class="anchored" data-anchor-id="step-6-the-final-black-scholes-formula">Step 6: The Final Black-Scholes Formula</h3>
<p>By recombining our solved integrals (Part A - Part B), we finally arrive at the glorious, closed-form Black-Scholes formula for a European Call option:</p>
<p><span class="math display">\[
C(S, t) = S_t N(d_1) - K e^{-r\tau} N(d_2)
\]</span></p>
<p>Where: <span class="math display">\[
d_1 = \frac{\ln(S_t/K) + (r + \frac{\sigma^2}{2})\tau}{\sigma \sqrt{\tau}}
\]</span> <span class="math display">\[
d_2 = d_1 - \sigma \sqrt{\tau} = \frac{\ln(S_t/K) + (r - \frac{\sigma^2}{2})\tau}{\sigma \sqrt{\tau}}
\]</span></p>
<section id="financial-intuition-of-the-formula" class="level4">
<h4 class="anchored" data-anchor-id="financial-intuition-of-the-formula">Financial Intuition of the Formula</h4>
<p>The math is beautiful, but what does it actually mean for a trader? * <strong><span class="math inline">\(N(d_2)\)</span></strong> is the risk-neutral probability that the option will expire “in-the-money” (that <span class="math inline">\(S_T &gt; K\)</span>). Therefore, <span class="math inline">\(K e^{-r\tau} N(d_2)\)</span> is simply the expected cost of having to pay the strike price at expiration, discounted to today. * <strong><span class="math inline">\(N(d_1)\)</span></strong> is the option’s Delta (<span class="math inline">\(\Delta\)</span>). It represents the probability-weighted expected value of the stock, <em>conditional</em> on the option expiring in the money. * Therefore, the formula simply says: <strong>Call Price = (Expected Benefit of receiving the stock) - (Expected Cost of paying the strike).</strong></p>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/jordanchongja\.github\.io");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p><span class="p-1">Made with <a href="https://quarto.org/">Quarto</a>.</span></p>
</div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/jordanchongja">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/jordan-chong-88a02b172/">
      <i class="bi bi-linkedin" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="mailto:jordanchongjian25@gmail.com">
      <i class="bi bi-envelope" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item">
 |
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="https://github.com/jordanchongja/jordanchongja.github.io">
<p>Source</p>
</a>
  </li>  
</ul>
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="../../../license.html">
<p>License</p>
</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="../../../contact.html">
<p>Contact</p>
</a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>