{"title":"3. Heston Model","markdown":{"yaml":{"title":"3. Heston Model","author":"Jordan Chong","date":"2024-02-22","format":{"html":{"theme":"lux","toc":true,"toc-depth":3,"number-sections":true,"code-fold":"show","code-tools":true,"df-print":"paged"}},"execute":{"warning":false,"echo":true}},"headingText":"Option Pricing: Black-Scholes, Heston, and Merton","containsRefs":false,"markdown":"\n\n## Overall Objective: Understand and compare three fundamental option pricing models.\n\n<span style=\"color:gray; opacity: 0.5;\">**1. Black-Scholes:** The benchmark model assuming constant volatility.</span>  \n    <span style=\"color:gray; opacity: 0.5;\">_Provides a great baseline and is computationally efficient, but assumes constant $\\sigma$ which is unrealistic for modern markets._</span>\n\n<span style=\"color:gray; opacity: 0.5;\">**2. Merton Jump:** Adds \"jumps\" to the asset price to model market shocks.</span>  \n    <span style=\"color:gray; opacity: 0.5;\">_Captures \"Fat Tails\" and sudden crashes via Poisson jumps._</span>\n\n    \n<div style=\"border-left: 4px solid #2196F3; padding-left: 15px;\">\n\n**3. Heston: Adds stochastic volatility (volatility clustering and mean reversion).**   \n_Captures the \"Smirk\" or \"Skew\" via stochastic vol—essential for pricing OTM puts accurately._\n</div>\n\n\n\n\n# Model 3: The Heston Stochastic Volatility Model\n## Objective: Capturing the \"Leverage Effect\" and Volatility Clustering\n\nThe Black-Scholes model assumes volatility is a constant number. However, looking at the VIX, we know that volatility is highly dynamic. It clusters (high vol periods follow high vol periods) and it mean-reverts (eventually calms down).\n\nSteven Heston (1993) solved this by modeling the asset price and its variance as two correlated, random processes:\n\n### The Mathematical Intuition\nThe Heston model is governed by two Stochastic Differential Equations (SDEs):\n\n1. **The Asset Price Process:** $$\\frac{dS_t}{S_t} = \\mu dt + \\sqrt{v_t} dW_t^S$$\n2. **The Variance Process (CIR Process):** $$dv_t = \\kappa(\\theta - v_t)dt + \\xi \\sqrt{v_t} dW_t^v$$\n\n**The Parameters:**\n* $v_0$: Initial Variance.\n* $\\theta$ (Theta): Long-term average variance.\n* $\\kappa$ (Kappa): The rate of mean reversion (how fast vol returns to $\\theta$).\n* $\\xi$ (Xi): Volatility of Volatility (determines the convexity of the smile).\n* $\\rho$ (Rho): The Correlation between the two Brownian motions ($dW_t^S$ and $dW_t^v$). \n\n**The Magic of $\\rho$:** In equity markets like the S&P 500, $\\rho$ is heavily negative (around -0.7). When the market crashes, volatility explodes. This negative correlation is what mathematically drags the left side of the volatility smile upward, creating the \"Skew.\"\n\n### Pricing via Characteristic Functions\n\nSince there is no simple closed-form solution like Black-Scholes, we use the Fourier Transform method. The price is an integral of the Characteristic Function $\\phi$.\n\n**Important Note on Stability (Albrecher et al.):**\n\nStandard implementations of the Heston characteristic function often suffer from \"branch cut\" discontinuities, leading to numerical explosions (sawtooth graphs). We use the \"Albrecher\" representation to ensure the characteristic function remains continuous and stable.\n\n## Imports and Setup\n","srcMarkdownNoYaml":"\n\n# Option Pricing: Black-Scholes, Heston, and Merton\n## Overall Objective: Understand and compare three fundamental option pricing models.\n\n<span style=\"color:gray; opacity: 0.5;\">**1. Black-Scholes:** The benchmark model assuming constant volatility.</span>  \n    <span style=\"color:gray; opacity: 0.5;\">_Provides a great baseline and is computationally efficient, but assumes constant $\\sigma$ which is unrealistic for modern markets._</span>\n\n<span style=\"color:gray; opacity: 0.5;\">**2. Merton Jump:** Adds \"jumps\" to the asset price to model market shocks.</span>  \n    <span style=\"color:gray; opacity: 0.5;\">_Captures \"Fat Tails\" and sudden crashes via Poisson jumps._</span>\n\n    \n<div style=\"border-left: 4px solid #2196F3; padding-left: 15px;\">\n\n**3. Heston: Adds stochastic volatility (volatility clustering and mean reversion).**   \n_Captures the \"Smirk\" or \"Skew\" via stochastic vol—essential for pricing OTM puts accurately._\n</div>\n\n\n\n\n# Model 3: The Heston Stochastic Volatility Model\n## Objective: Capturing the \"Leverage Effect\" and Volatility Clustering\n\nThe Black-Scholes model assumes volatility is a constant number. However, looking at the VIX, we know that volatility is highly dynamic. It clusters (high vol periods follow high vol periods) and it mean-reverts (eventually calms down).\n\nSteven Heston (1993) solved this by modeling the asset price and its variance as two correlated, random processes:\n\n### The Mathematical Intuition\nThe Heston model is governed by two Stochastic Differential Equations (SDEs):\n\n1. **The Asset Price Process:** $$\\frac{dS_t}{S_t} = \\mu dt + \\sqrt{v_t} dW_t^S$$\n2. **The Variance Process (CIR Process):** $$dv_t = \\kappa(\\theta - v_t)dt + \\xi \\sqrt{v_t} dW_t^v$$\n\n**The Parameters:**\n* $v_0$: Initial Variance.\n* $\\theta$ (Theta): Long-term average variance.\n* $\\kappa$ (Kappa): The rate of mean reversion (how fast vol returns to $\\theta$).\n* $\\xi$ (Xi): Volatility of Volatility (determines the convexity of the smile).\n* $\\rho$ (Rho): The Correlation between the two Brownian motions ($dW_t^S$ and $dW_t^v$). \n\n**The Magic of $\\rho$:** In equity markets like the S&P 500, $\\rho$ is heavily negative (around -0.7). When the market crashes, volatility explodes. This negative correlation is what mathematically drags the left side of the volatility smile upward, creating the \"Skew.\"\n\n### Pricing via Characteristic Functions\n\nSince there is no simple closed-form solution like Black-Scholes, we use the Fourier Transform method. The price is an integral of the Characteristic Function $\\phi$.\n\n**Important Note on Stability (Albrecher et al.):**\n\nStandard implementations of the Heston characteristic function often suffer from \"branch cut\" discontinuities, leading to numerical explosions (sawtooth graphs). We use the \"Albrecher\" representation to ensure the characteristic function remains continuous and stable.\n\n## Imports and Setup\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"paged","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":false,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"jupyter"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"show","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":true,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css"],"toc":true,"toc-depth":3,"number-sections":true,"output-file":"quarto_03_HestonModel.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.8.27","theme":"lux","title":"3. Heston Model","author":"Jordan Chong","date":"2024-02-22"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}