{"title":"1. Black-Sholes Model","markdown":{"yaml":{"title":"1. Black-Sholes Model","author":"Jordan Chong","date":"2024-02-22","format":{"html":{"theme":"lux","toc":true,"toc-depth":3,"number-sections":true,"code-fold":"show","code-tools":true,"df-print":"paged"}},"execute":{"warning":false,"echo":true}},"headingText":"Option Pricing: Black-Scholes, Heston, and Merton","containsRefs":false,"markdown":"\n\n## Overall Objective: Understand and compare three fundamental option pricing models.\n\n<div style=\"border-left: 4px solid #2196F3; padding-left: 15px;\">\n    \n**1. Black-Scholes: The benchmark model assuming constant volatility.**  \n_Provides a great baseline and is computationally efficient, but assumes constant $\\sigma$ which is unrealistic for modern markets._\n</div>\n\n<span style=\"color:gray; opacity: 0.5;\">**2. Heston:** Adds stochastic volatility (volatility clustering and mean reversion).</span>  \n    <span style=\"color:gray; opacity: 0.5;\">_Captures the \"Smirk\" or \"Skew\" via stochastic vol—essential for pricing OTM puts accurately._</span>\n    \n<span style=\"color:gray; opacity: 0.5;\">**3. Merton Jump:** Adds \"jumps\" to the asset price to model market shocks.</span>  \n    <span style=\"color:gray; opacity: 0.5;\">_Captures \"Fat Tails\" and sudden crashes via Poisson jumps._</span>\n\n\n## 1. Black-Scholes Model\n\nThe Black-Scholes model assumes the stock price $S_t$ follows a Geometric Brownian Motion (GBM):$$dS_t = \\mu S_t dt + \\sigma S_t dW_t$$\n\nWe can deconstruct this engine into two distinct components:\n* **The Deterministic Drift ($\\mu S_t dt$):** This represents the expected, constant growth rate of the asset. If market volatility were zero, the stock would simply grow smoothly at rate $\\mu$, compounding like money in a standard savings account.\n  \n* **The Stochastic Diffusion ($\\sigma S_t dW_t$):** This injects the randomness. $dW_t$ is a Wiener process (Standard Brownian Motion) representing unpredictable market shocks. By scaling this randomness by the current stock price ($S_t$), the model ensures that the asset price can never drop below zero, perfectly reflecting the reality of limited liability in equities.\nWhere:   \n- $\\mu$ is the drift.  \n- $\\sigma$ is the constant volatility.  \n- $dW_t$ is a Wiener process (Brownian motion). \n<br>\n\n**Call Option Formula**  \nThe price of a European Call option $C(S, t)$ is given by:  \n$$C(S, t) = S_0 e^{-qT} N(d_1) - K e^{-rT} N(d_2)$$\n<br>\nWhere $N(\\cdot)$ is the cumulative distribution function of the standard normal distribution, and:  \n$$d_1 = \\frac{\\ln(S_0/K) + (r - q + \\sigma^2/2)T}{\\sigma\\sqrt{T}}$$$$d_2 = d_1 - \\sigma\\sqrt{T}$$  \n\n###\n**Volatility Drag (The Asymmetry of Returns):**  \nBecause asset returns compound geometrically, downward price movements penalize the overall value more severely than upward movements of the exact same percentage. A 50% drop requires a 100% gain just to recover the initial capital. \n\nMathematically, this \"volatility drag\" manifests when we apply Ito's Lemma to the log-return process, introducing a $-\\frac{1}{2}\\sigma^2$ variance penalty term. The higher the volatility, the stronger this downward drag on the expected geometric return.\n\n## Imports and Setup\n\n## Simulating Black-Scholes\nVisualizes the core assumption of the Black-Scholes model: that asset prices follow a log-normal random walk with constant drift and volatility. This Monte Carlo simulation provides a physical intuition for the probability distribution of terminal stock prices.\n\n## 2. Black-Scholes Call Pricing & The Greeks\n\nImplements the closed-form analytical solutions for European Call options. We visualize Delta against the underlying asset price to demonstrate the dynamic, non-linear nature of option sensitivities, introducing the concept of continuous delta-hedging.\n\nMapping of the \"Big Five\" Greeks ($\\Delta$, $\\Gamma$, $\\Theta$, $\\nu$, $\\rho$). By visualizing these simultaneously, we can analyze the multi-dimensional risk exposure of an option contract as the underlying spot price moves across different moneyness levels.\n\nCompletes the basic pricing suite by adding European Put options. We run a computational check to validate our formulas against the Put-Call Parity theorem ($C - P = S_0 e^{-qT} - K e^{-rT}$), ensuring our engine respects fundamental no-arbitrage constraints.\n\n## 3. The Options Pricing Surface\n\nOptions pricing is inherently multi-dimensional. The price is not just a function of the underlying asset's price, but also its strike price and the time remaining until expiration. \n\nBy calculating the Black-Scholes price across a grid of different strikes and maturities, we can generate a 3D pricing surface. This visualizes how Out-Of-The-Money (OTM) options lose value rapidly as expiration approaches, while In-The-Money (ITM) options converge exactly to their intrinsic payoff.\n\nShifts from 2D static plots to an interactive 3D surface mapping the Call price against both Strike and Time to Maturity. This allows for a deeper geometric understanding of how time decay and moneyness compound together.\n\nWe use a Brent root-finding algorithm to back-calculate the market's implied volatility from our observed option prices. The resulting plot proves that the Black-Scholes assumption of constant volatility is empirically false—setting up the necessity for the advanced, volatility-skew-aware models in the subsequent notebooks.\n","srcMarkdownNoYaml":"\n\n# Option Pricing: Black-Scholes, Heston, and Merton\n## Overall Objective: Understand and compare three fundamental option pricing models.\n\n<div style=\"border-left: 4px solid #2196F3; padding-left: 15px;\">\n    \n**1. Black-Scholes: The benchmark model assuming constant volatility.**  \n_Provides a great baseline and is computationally efficient, but assumes constant $\\sigma$ which is unrealistic for modern markets._\n</div>\n\n<span style=\"color:gray; opacity: 0.5;\">**2. Heston:** Adds stochastic volatility (volatility clustering and mean reversion).</span>  \n    <span style=\"color:gray; opacity: 0.5;\">_Captures the \"Smirk\" or \"Skew\" via stochastic vol—essential for pricing OTM puts accurately._</span>\n    \n<span style=\"color:gray; opacity: 0.5;\">**3. Merton Jump:** Adds \"jumps\" to the asset price to model market shocks.</span>  \n    <span style=\"color:gray; opacity: 0.5;\">_Captures \"Fat Tails\" and sudden crashes via Poisson jumps._</span>\n\n\n## 1. Black-Scholes Model\n\nThe Black-Scholes model assumes the stock price $S_t$ follows a Geometric Brownian Motion (GBM):$$dS_t = \\mu S_t dt + \\sigma S_t dW_t$$\n\nWe can deconstruct this engine into two distinct components:\n* **The Deterministic Drift ($\\mu S_t dt$):** This represents the expected, constant growth rate of the asset. If market volatility were zero, the stock would simply grow smoothly at rate $\\mu$, compounding like money in a standard savings account.\n  \n* **The Stochastic Diffusion ($\\sigma S_t dW_t$):** This injects the randomness. $dW_t$ is a Wiener process (Standard Brownian Motion) representing unpredictable market shocks. By scaling this randomness by the current stock price ($S_t$), the model ensures that the asset price can never drop below zero, perfectly reflecting the reality of limited liability in equities.\nWhere:   \n- $\\mu$ is the drift.  \n- $\\sigma$ is the constant volatility.  \n- $dW_t$ is a Wiener process (Brownian motion). \n<br>\n\n**Call Option Formula**  \nThe price of a European Call option $C(S, t)$ is given by:  \n$$C(S, t) = S_0 e^{-qT} N(d_1) - K e^{-rT} N(d_2)$$\n<br>\nWhere $N(\\cdot)$ is the cumulative distribution function of the standard normal distribution, and:  \n$$d_1 = \\frac{\\ln(S_0/K) + (r - q + \\sigma^2/2)T}{\\sigma\\sqrt{T}}$$$$d_2 = d_1 - \\sigma\\sqrt{T}$$  \n\n###\n**Volatility Drag (The Asymmetry of Returns):**  \nBecause asset returns compound geometrically, downward price movements penalize the overall value more severely than upward movements of the exact same percentage. A 50% drop requires a 100% gain just to recover the initial capital. \n\nMathematically, this \"volatility drag\" manifests when we apply Ito's Lemma to the log-return process, introducing a $-\\frac{1}{2}\\sigma^2$ variance penalty term. The higher the volatility, the stronger this downward drag on the expected geometric return.\n\n## Imports and Setup\n\n## Simulating Black-Scholes\nVisualizes the core assumption of the Black-Scholes model: that asset prices follow a log-normal random walk with constant drift and volatility. This Monte Carlo simulation provides a physical intuition for the probability distribution of terminal stock prices.\n\n## 2. Black-Scholes Call Pricing & The Greeks\n\nImplements the closed-form analytical solutions for European Call options. We visualize Delta against the underlying asset price to demonstrate the dynamic, non-linear nature of option sensitivities, introducing the concept of continuous delta-hedging.\n\nMapping of the \"Big Five\" Greeks ($\\Delta$, $\\Gamma$, $\\Theta$, $\\nu$, $\\rho$). By visualizing these simultaneously, we can analyze the multi-dimensional risk exposure of an option contract as the underlying spot price moves across different moneyness levels.\n\nCompletes the basic pricing suite by adding European Put options. We run a computational check to validate our formulas against the Put-Call Parity theorem ($C - P = S_0 e^{-qT} - K e^{-rT}$), ensuring our engine respects fundamental no-arbitrage constraints.\n\n## 3. The Options Pricing Surface\n\nOptions pricing is inherently multi-dimensional. The price is not just a function of the underlying asset's price, but also its strike price and the time remaining until expiration. \n\nBy calculating the Black-Scholes price across a grid of different strikes and maturities, we can generate a 3D pricing surface. This visualizes how Out-Of-The-Money (OTM) options lose value rapidly as expiration approaches, while In-The-Money (ITM) options converge exactly to their intrinsic payoff.\n\nShifts from 2D static plots to an interactive 3D surface mapping the Call price against both Strike and Time to Maturity. This allows for a deeper geometric understanding of how time decay and moneyness compound together.\n\nWe use a Brent root-finding algorithm to back-calculate the market's implied volatility from our observed option prices. The resulting plot proves that the Black-Scholes assumption of constant volatility is empirically false—setting up the necessity for the advanced, volatility-skew-aware models in the subsequent notebooks.\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"paged","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":false,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"jupyter"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"show","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":true,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css"],"toc":true,"toc-depth":3,"number-sections":true,"output-file":"quarto_01_BlackSholes.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.8.27","theme":"lux","title":"1. Black-Sholes Model","author":"Jordan Chong","date":"2024-02-22"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}